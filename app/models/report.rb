=begin
METRICS API

The SASHIMI API represents a RESTful implementation of SUSHI automation intended to returns COUNTER Research Data Release 1 reports

OpenAPI spec version: 1.0.0
Contact: support@datacite.org
Generated by: https://github.com/swagger-api/swagger-codegen.git

=end

require 'base32/url'

class Report < ApplicationRecord
  validates_presence_of :report_id, :created_by, :report_datasets, :client_id, :provider_id

  serialize :exceptions, Array
  before_create :set_id

  def uid
    Base32::URL.encode(id, split: 4, length: 16)
  end

  private

  # random number that fits into MySQL bigint field (8 bytes)
  def set_id
    self.id = SecureRandom.random_number(9223372036854775807)
  end
end
